#Comandos Mysql

//Version: Saber la version de Mysql
mysql --version

//Status: Saber el estado de mysql
service mysql status
mysqladmin -p -u root version

//Entrar a mysql: La clave es 1234
mysql -u root -p

//Crear una base de datos
CREATE DATABASE dbname;

//Mostrar: Mostrar bases de datos.
show databases;

//Seleccionar: Seleccionar database
USE mote1;
USE sink;

//Mostrar las columnas de una Tabla
DESCRIBE int_50_tx;



//Tabla: Crear tabla dentro de la base de datos
CREATE TABLE Variables (id INT NOT NULL PRIMARY KEY AUTO_INCREMENT, temperature INT(4), light INT(4));

create table weatherData (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
tempC decimal(6,2) NOT NULL,
light decimal(6,2) NOT NULL
);

create table weatherData (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
tempC INT(4) NOT NULL,
light INT(4) NOT NULL
);

create table weatherData (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
secuencia INT(11) NOT NULL,
tempC INT(4) NOT NULL,
light INT(4) NOT NULL
);

create table LinkStatistics (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
nodeID DECIMAL(5,2) NOT NULL, //The first argument is precision, which is the number of total digits. The second argument is scale which is the maximum number of digits to the right of the decimal point. Thus, (4,2) can be anything from -99.99 to 99.99.
secuencia INT(11) NOT NULL,
tempC INT(4) NOT NULL,
light INT(4) NOT NULL,
RSSI  INT(4) NOT NULL,
LQI   INT(4) NOT NULL
);

create table LinkStatistics (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
nodeID DECIMAL(5,2) NOT NULL,
secuencia INT(11) NOT NULL,
tempC INT(4) NOT NULL,
light INT(4) NOT NULL,
RSSI  INT(4) NOT NULL,
LQI   INT(4) NOT NULL
);

create table LinkStatisticsPaper2 (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
nodeID DECIMAL(5,2) NOT NULL,
secuencia INT(11) NOT NULL,
tempC INT(4) NOT NULL,
light INT(4) NOT NULL,
RSSI  INT(4) NOT NULL,
LQI   INT(4) NOT NULL,
latency   INT(4) NOT NULL,
date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

//For plotting the tree in python in real-time
create table msg (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
nodeID DECIMAL(5,2) NOT NULL,
seqno INT(11) NOT NULL,
x INT(5) NOT NULL,
y INT(5) NOT NULL,
parent DECIMAL(5,2) NOT NULL,
tempC INT(5) NOT NULL,
VDD INT(5) NOT NULL,
date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

//For recording statistics when the interference is 50%
create table int_60_tx (
id INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
num_packets INT(11) NOT NULL,
btp FLOAT(8,2),
EWMA_btp_09 FLOAT(8,2),
EWMA_btp_08 FLOAT(8,2),
EWMA_btp_07 FLOAT(8,2),
EWMA_btp_06 FLOAT(8,2),
EWMA_btp_05 FLOAT(8,2),
EWMA_btp_04 FLOAT(8,2),
EWMA_btp_03 FLOAT(8,2),
EWMA_btp_02 FLOAT(8,2),
EWMA_btp_01 FLOAT(8,2),
ppl FLOAT(8,2),
EWMA_ppl_09 FLOAT(8,2),
EWMA_ppl_08 FLOAT(8,2),
EWMA_ppl_07 FLOAT(8,2),
EWMA_ppl_06 FLOAT(8,2),
EWMA_ppl_05 FLOAT(8,2),
EWMA_ppl_04 FLOAT(8,2),
EWMA_ppl_03 FLOAT(8,2),
EWMA_ppl_02 FLOAT(8,2),
EWMA_ppl_01 FLOAT(8,2),
date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

//Mostrar Tablas:
show tables;

//Insertar: Insertar algo dentro de la tabla.
INSERT INTO int_50_tx (id,num_packets,btp,EWMA_btp_09,EWMA_btp_08,EWMA_btp_07,EWMA_btp_06,EWMA_btp_05,EWMA_btp_04,
                       EWMA_btp_03,EWMA_btp_02,EWMA_btp_01,ppl,EWMA_ppl_09,EWMA_ppl_08,EWMA_ppl_07,EWMA_ppl_06,EWMA_ppl_05,
                       EWMA_ppl_04,EWMA_ppl_03,EWMA_ppl_02,EWMA_ppl_01)
                       VALUES (NULL,8980,1178.90,1182.54,1181.91,1177.37,1168.28,1153.14,1129.90,1096.56,1052.80,1002.59,
                                    1.00,1.00,1.00,1.00,1.00,1.00,1.00,.99,.99,.99 );

INSERT INTO weatherData (id, tempC, light) VALUES (NULL, 30, 200);
INSERT INTO LinkStatistics (id, nodeID, secuencia, tempC, light, RSSI, LQI) VALUES (NULL, 2.0 ,1, 30, 200, -74, 107 );
INSERT INTO LinkStatisticsPaper (id, nodeID, secuencia, tempC, light, RSSI, LQI, latency) VALUES (NULL, 2.0 ,18, 22, 191, 64, 107, 85 );
INSERT INTO msg (id, nodeID, seqno, parent , tempC, VDD) VALUES (NULL, 2.0 , 1, 1.0, 27380, 3293);
INSERT INTO msg (id, nodeID, seqno, x, y, parent, tempC, VDD) VALUES (NULL, 6.0 , 1, 11, 12, 2.0, 27380, 3293);



//Ver: Ver valores insertados en la tabla
select * from weatherData;
select * from LinkStatistics;
select * from LinkStatisticsPaper;
select * from LinkStatisticsPaper where id=1;
select * from msg;
select * from int_50_tx;

//Eliminar: Elimina tabla
DROP TABLE weatherData;
DROP TABLE LinkStatistics;
DROP TABLE msg;
DROP TABLE int_50_tx;

//Borrar datos de una tabla
DELETE FROM weatherData;
DELETE FROM LinkStatistics;
DELETE FROM LinkStatisticsPaper;
DELETE FROM msg;
DELETE FROM int_50_tx;

//Reset AUTO_INCREMENT a 1
ALTER TABLE weatherData AUTO_INCREMENT = 1;
ALTER TABLE LinkStatisticsPaper AUTO_INCREMENT = 1;
ALTER TABLE msg AUTO_INCREMENT = 1;

//Propiedades: Ver las propiedades de una tabla
SHOW COLUMNS FROM weatherData;
SHOW COLUMNS FROM LinkStatistics;
SHOW COLUMNS FROM LinkStatisticsPaper;
SHOW COLUMNS FROM LinkStatisticsPaper2;

//Sacar datos en un csv file.Get a csv file.


SELECT "id","nodeID","secuencia","tempC","light","RSSI","LQI","timestamp"
UNION ALL
SELECT *
FROM LinkStatistics
INTO OUTFILE "/var/lib/mysql-files/LinkStatistics.csv"
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n';

SELECT "id","nodeID","secuencia","tempC","light","RSSI","LQI","latency","date"
UNION ALL
SELECT *
FROM LinkStatisticsPaper
INTO OUTFILE "/var/lib/mysql-files/LinkStatisticsPaperV3_21_2.csv"
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n';

SELECT "id","num_packets","btp","EWMA_btp_09","EWMA_btp_08","EWMA_btp_07","EWMA_btp_06","EWMA_btp_05","EWMA_btp_04","EWMA_btp_03","EWMA_btp_02","EWMA_btp_01","ppl","EWMA_ppl_09","EWMA_ppl_08","EWMA_ppl_07","EWMA_ppl_06","EWMA_ppl_05","EWMA_ppl_04","EWMA_ppl_03","EWMA_ppl_02","EWMA_ppl_01","date"
UNION ALL
SELECT *
FROM int_60_tx
INTO OUTFILE "/var/lib/mysql-files/int_60_tx.csv"
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n';

cp /var/lib/mysql-files/LinkStatisticsPaperV3_21_2.csv /home/sink/Desktop/contiki/examples/paperInterferingNode/Results_Paper_Interfering_Node/


//abrir el archivo de python para guardar los datos en mysql
  //antes toca seguir tutorial en http://contiki-iot.blogspot.com/2016/06/sending-data-from-sky-motes-to-mysql.html
python serial-mysql.py


DELETE FROM LinkStatisticsPaper; ALTER TABLE LinkStatisticsPaper AUTO_INCREMENT = 1; select * from LinkStatisticsPaper;
